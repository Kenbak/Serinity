

<!-- ------------------------------- Index qui permet au docteur de voire tous ces patients ------------------------------- -->


<% if current_user.role == 'doctor' %>
  <!DOCTYPE html>
  <html lang="fr">
    <head>
      <meta charset="UTF-8">
      <title>Résumé des Patients - Dr <%= @user.last_name.upcase %></title>
      <link rel="stylesheet" href="styles.css">
    </head>
    <body class="patients-home">

      <%= render "shared/nav-dashboard" %>

      <div class="main-content">
        <h1>Mes patients<span class="counterpatient"><%= User.where(role: "patient").count %></span></h1>
        <div class="patients-search">
          <input type="text" placeholder="Recherchez un patient" class="recherche">
        </div>
        <div class="patients-container">
          <% @patients.each do |patient| %>
            <div class="patient-card">
              <div class="patient-info">
                <div class="patient-avatar"> <!-- Ajoutez la classe "patient-avatar" ici -->
                  <%= link_to user_path(patient.id), class: "link-card-users" do %>
                    <% if patient.photo.attached? %>
                      <%= cl_image_tag patient.photo.key, crop: :fill, class: "avatar" %>
                    <% else %>
                      <%= image_tag("pp_default.png", class: "avatar") %>
                    <% end %>
                  <% end %>
                </div>

                 <div class="show-more">
                    <%= link_to "Voir plus", user_path(patient.id) %>

                  </div>



                <div class="patient-name">
                  <p><%= "#{patient.first_name.capitalize} #{patient.last_name.upcase}" %></p>
                </div>
                <div class="patient-details">
                  <span>
                    <i class="fas fa-envelope" style="font-size: 0.7rem; padding-top: 6px; padding-left: 8px; opacity: 0.6;"></i>
                    <%= patient.email %>
                  </span>
                  <span>
                    <i class="fas fa-phone" style="font-size: 0.7rem; padding-top: 6px; padding-left: 8px; opacity: 0.6; "></i>
                    <%= patient.number %>
                  </span>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </body>
  </html>
<% end %>



<!-- ------------------------------- Index qui permet au patient de voire tous les docteurs ------------------------------- -->




<% if current_user.role == 'patient' %>

  <div class="index-container">

    <div class="search-container">

      <%= render "search" %>

      <h1>Psychologue</h1>

      <div class="index-card-containe-positionr">

      <!-- ------------------------------------- MapBox ------------------------------------- -->

        <div style="width: 500px; height: 400px;"
            data-controller="map"
            data-map-markers-value="<%= @markers.to_json %>"
            data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>

      <!-- ------------------------------------- MapBox ------------------------------------- -->

        <div class="index-card-container">
          <% @doctors.each do |doctor| %>
            <div class="index-card">

              <%= link_to user_path(doctor.id), class: "link-card-users" do %>

                <% if doctor.photo.attached?  %>
                  <%= cl_image_tag doctor.photo.key, crop: :fill %>
                <% else %>
                  <%= image_tag("pp_default.png") %>
                <% end %>

                <div class="user-info-index">
                  <div class="user-name-age">
                    <p><%= doctor.first_name %></p>
                    <p><%= doctor.last_name.capitalize %></p>
                    <p><%= doctor.age %> ans</p>
                  </div>
                  <div class="user-num-info">
                    <p><%= doctor.number %></p>
                  </div>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
<% end %>
